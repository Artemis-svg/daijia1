<!--orders.wxml-->
<navigation-bar title="æ¥å•" back="{{false}}" color="black" background="#FFF"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- å¸æœºçŠ¶æ€å¡ç‰‡ -->
    <view class="driver-status-card">
      <view class="status-header">
        <view class="status-indicator {{driverStatus}}"></view>
        <text class="status-text">{{statusText}}</text>
        <button class="toggle-status-btn {{isLoading ? 'loading' : ''}}" bindtap="toggleStatus" disabled="{{isLoading}}">
          {{isLoading ? 'æ›´æ–°ä¸­...' : (driverStatus === 'online' ? 'ä¸‹çº¿' : 'ä¸Šçº¿')}}
        </button>
      </view>
      <view class="driver-info">
        <text class="driver-name">{{driverInfo.name}}</text>
        <text class="driver-car">{{driverInfo.carModel}} Â· {{driverInfo.plateNumber}}</text>
        <text class="today-earnings">ä»Šæ—¥æ”¶ç›Š: Â¥{{todayEarnings}}</text>
      </view>
    </view>

    <!-- å½“å‰è®¢å• -->
    <view class="current-order" wx:if="{{currentOrder}}">
      <view class="section-header">
        <text class="section-title">å½“å‰è®¢å•</text>
        <text class="order-status">{{currentOrder.status}}</text>
      </view>
      <view class="order-details">
        <view class="route-info">
          <view class="route-item">
            <view class="route-dot start"></view>
            <text class="route-text">{{currentOrder.startAddress}}</text>
          </view>
          <view class="route-line"></view>
          <view class="route-item">
            <view class="route-dot end"></view>
            <text class="route-text">{{currentOrder.endAddress}}</text>
          </view>
        </view>
        <view class="customer-info">
          <text class="customer-name">ä¹˜å®¢: {{currentOrder.customerName}}</text>
          <text class="customer-phone">{{currentOrder.customerPhone}}</text>
        </view>
        <view class="order-actions">
          <button class="action-btn secondary" bindtap="contactCustomer">è”ç³»ä¹˜å®¢</button>
          <button class="action-btn primary" bindtap="completeOrder">å®Œæˆè®¢å•</button>
        </view>
      </view>
    </view>

    <!-- å¯æ¥è®¢å•åˆ—è¡¨ -->
    <view class="available-orders" wx:if="{{driverStatus === 'online' && !currentOrder}}">
      <text class="section-title">å¯æ¥è®¢å•</text>
      <view class="orders-list">
        <view class="order-item" wx:for="{{availableOrders}}" wx:key="id">
          <view class="order-header">
            <text class="order-time">{{item.time}}</text>
            <text class="order-distance">è·ç¦»{{item.distance}}km</text>
          </view>
          <view class="route-info">
            <view class="route-item">
              <view class="route-dot start"></view>
              <text class="route-text">{{item.startAddress}}</text>
            </view>
            <view class="route-line"></view>
            <view class="route-item">
              <view class="route-dot end"></view>
              <text class="route-text">{{item.endAddress}}</text>
            </view>
          </view>
          <view class="order-footer">
            <text class="order-price">é¢„ä¼°æ”¶ç›Š: Â¥{{item.price}}</text>
            <button class="accept-btn" bindtap="acceptOrder" data-order="{{item}}">æ¥å•</button>
          </view>
        </view>
      </view>
    </view>

    <!-- ç¦»çº¿çŠ¶æ€æç¤º -->
    <view class="offline-tips" wx:if="{{driverStatus === 'offline'}}">
      <view class="tips-icon">ğŸ’¤</view>
      <text class="tips-title">æ‚¨å½“å‰å¤„äºç¦»çº¿çŠ¶æ€</text>
      <text class="tips-desc">ç‚¹å‡»ä¸Šçº¿æŒ‰é’®å¼€å§‹æ¥å•</text>
    </view>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <view class="stats-section">
      <text class="section-title">ä»Šæ—¥æ•°æ®</text>
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-number">{{todayStats.orders}}</text>
          <text class="stat-label">å®Œæˆè®¢å•</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{todayStats.hours}}</text>
          <text class="stat-label">åœ¨çº¿æ—¶é•¿(h)</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{todayStats.rating}}</text>
          <text class="stat-label">å¹³å‡è¯„åˆ†</text>
        </view>
      </view>
    </view>
  </view>
</scroll-view>

<!-- å¸æœºä¸“ç”¨åº•éƒ¨å¯¼èˆª -->
<view class="driver-tabbar">
  <view class="tabbar-item active">
    <text class="tabbar-icon">ğŸ“‹</text>
    <text class="tabbar-text">æ¥å•</text>
  </view>
  <view class="tabbar-item" bindtap="goToHistory">
    <text class="tabbar-icon">ğŸ“„</text>
    <text class="tabbar-text">å†å²è®¢å•</text>
  </view>
  <view class="tabbar-item" bindtap="goToProfile">
    <text class="tabbar-icon">ğŸ‘¤</text>
    <text class="tabbar-text">ä¸ªäºº</text>
  </view>
</view>

